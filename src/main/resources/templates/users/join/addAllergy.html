<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<h1>알레르기</h1>
	<div>
		<div>
			<label for="allergy">알레르기</label>
			<input id="allergy" name="allergy" />
			<button type="button">검색</button>
			<button type="button" onclick="addAllergy()">추가</button>
		</div>
		<div>
			<form action="/join/joinSuccess" method="post" th:object="${usersInfoForm}">
			
				<div id="addAllergy">
				</div>
				
				<div>
					<button type="button" th:onclick="|location.href='@{/join/addUsingDrugs}'|">이전</button>
					<button type="submit" onclick="joinOrHome()">추가완료</button>
				</div>
			</form>
		</div>
	</div>
	
	<script>
		function joinOrHome() {
			if(confirm('다른 가족을 추가하시겠습니까?')) {
				//yes
				location.href='/join/addInfo';
			} else {
				//no
				location.href='/';
			}
		}
		

		function addAllergy() {
			//input 추가할 div 찾기
			const addAllergy = document.getElementById('addAllergy');
			//입력된 알러지 가져오기
			let inputValue = document.getElementById('allergy').value;
			//추가 기능(inputvalue 값이 있을 때만 추가되도록)
			if (inputValue != null && inputValue.trim() != "") {
				addAllergy.innerHTML += '<div id="'+inputValue+'box"><label for="'+inputValue+'">'
						+ inputValue
						+ '</lable><input name="allergyList" id="'+inputValue+'" type="hidden" value="'+inputValue+'"/><button type="button" onclick="deleteDrug(\''
						+ inputValue + 'box\')">삭제</button></div>'
			}
		}

		function deleteDrug(inputValuebox) {
			console.log(inputValuebox);
			document.getElementById(inputValuebox).remove();
		}
	</script>
</body>
</html>